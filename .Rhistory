filter(Country == 'France' & 'India')
library(forcats)
Industry <- read.csv("v1industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry
filter(Country == 'France' , 'India')
library(forcats)
Industry <- read.csv("v1industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('France', 'India'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
#facet_wrap(~industry, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 1000000, by = 1000)
) +
theme_minimal() +
labs(
title = "Industry Vs Country",
x = "Country",
y = "Emission",
caption = "Source: Your Source"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
library(forcats)
Industry <- read.csv("v1industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('France', 'India'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 1000000, by = 1000)
) +
theme_minimal() +
labs(
title = "Industry Vs Country",
x = "Country",
y = "Emission",
caption = "Source: Your Source"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
library(forcats)
Industry <- read.csv("v1industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('France', 'India'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 10000, by = 100)
) +
theme_minimal() +
labs(
title = "Industry Vs Country",
x = "Country",
y = "Emission",
caption = "Source: Your Source"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
library(forcats)
Industry <- read.csv("v1industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('France', 'India'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 10000, by = 100)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "Country",
y = "Emission",
caption = "Source: Your Source"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
library(forcats)
Industry <- read.csv("v1industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France',))
library(forcats)
Industry <- read.csv("v1industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 10000, by = 100)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "Country",
y = "Emission",
caption = "Source: Your Source"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
library(forcats)
Industry <- read.csv("v1industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 500, by = 50)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "Country",
y = "Emission",
caption = "Source: Your Source"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
reticulate::repl_python()
reticulate::repl_python()
import pyodbc
import pandas as pd
cn=pyodbc.connect('DRIVER={SQL Server};SERVER=localhost;PORT=1433;DATABASE=CDMS;UID=sa;PWD=MyPass@word')
cursor = cn.cursor()
surfacetemp= pd.read_sql("""
SELECT i.Country,c.industry, Year, sum(Value) as Emission
FROM country_master as i
LEFT JOIN CO2country_industry ON i.Country_code = CO2country_code
LEFT JOIN industry_master as c ON c.industry_code = co2Industry_code
WHERE i.Country IS NOT NULL
AND c.industry IN ('Agriculture, Forestry and Fishing','Construction',
'Electricity, gas, steam and air conditioning supply','Manufacturing','Mining','Food products, beverages and tobacco','Air transport','Chemicals and pharmaceutical products',
'Water transport','Rubber and plastics products')
GROUP BY i.Country, c.industry, Year
ORDER BY Emission ;
""", cn)
cursor.close()
surfacetemp.to_csv("V2industry_vs_contry_vs_emission.csv", index= False)
quit
library(forcats)
Industry <- read.csv("v2industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 500, by = 50)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "Country",
y = "Emission",
caption = "Source: Your Source"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
library(forcats)
Industry <- read.csv("v2industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 5000, by = 100)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "year",
y = "Emission",
caption = "International Monetary Fund - IMF"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
reticulate::repl_python()
import pyodbc
import pandas as pd
cn=pyodbc.connect('DRIVER={SQL Server};SERVER=localhost;PORT=1433;DATABASE=CDMS;UID=sa;PWD=MyPass@word')
cursor = cn.cursor()
surfacetemp= pd.read_sql("""
SELECT i.Country,c.industry, Year, sum(Value) as Emission
FROM country_master as i
LEFT JOIN CO2country_industry ON i.Country_code = CO2country_code
LEFT JOIN industry_master as c ON c.industry_code = co2Industry_code
WHERE i.Country IS NOT NULL
AND c.industry IN ('Agriculture, Forestry and Fishing','Construction',
'Electricity, gas, steam and air conditioning supply','Manufacturing','Mining','Food products, beverages and tobacco','Air transport','Chemicals and pharmaceutical products',
'Water transport','Rubber and plastics products') AND unit IN ('Metric Tons of CO2 Emissions per $1million USD of output')
GROUP BY i.Country, c.industry, Year
ORDER BY Emission ;
""", cn)
cursor.close()
surfacetemp.to_csv("V3industry_vs_contry_vs_emission.csv", index= False)
quit
library(forcats)
Industry <- read.csv("v3industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 5000, by = 100)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "year",
y = "Emission",
caption = "International Monetary Fund - IMF"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
reticulate::repl_python()
import pyodbc
import pandas as pd
cn=pyodbc.connect('DRIVER={SQL Server};SERVER=localhost;PORT=1433;DATABASE=CDMS;UID=sa;PWD=MyPass@word')
cursor = cn.cursor()
surfacetemp= pd.read_sql("""
SELECT c.Country,i.industry, Year, AVG(Value) as Emission
--FROM country_master as i
FROM CO2country_industry
LEFT JOIN country_master as c ON c.country_code = CO2country_code
LEFT JOIN industry_master as i ON i.industry_code = co2Industry_code
WHERE c.Country IS NOT NULL
AND i.industry IN ('Agriculture, Forestry and Fishing','Construction',
'Electricity, gas, steam and air conditioning supply','Manufacturing','Mining',
'Transportation and Storage','Food products, beverages and tobacco','Air transport','Chemicals and pharmaceutical products',
'Water transport','Rubber and plastics products')
AND unit IN ('Metric Tons of CO2 Emissions per $1million USD of output')
GROUP BY c.Country, i.industry, Year
ORDER BY Emission desc;
""", cn)
cursor.close()
surfacetemp.to_csv("V4industry_vs_contry_vs_emission.csv", index= False)
quit
library(forcats)
Industry <- read.csv("v4industry_vs_contry_vs_emission.csv")
# Reorder the countries based on emissions
I#ndustry$Country <- fct_reorder(Industry$Country, desc(Industry$Emission))
# Manually set the order of levels for the "Mining" industry
#Industry$industry <- fct_relevel(Industry$industry, "Mining")
# Reorder the facets based on the sum of emissions within each industry
#Industry$industry <- fct_infreq(Industry$industry)
# Create the ggplot
p2 <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 5000, by = 100)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "year",
y = "Emission",
caption = "International Monetary Fund - IMF"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
reticulate::repl_python()
reticulate::repl_python()
cursor = cn.cursor()
surfacetemp= pd.read_sql("""
SELECT c.Country,i.industry, Year, AVG(Value) as Emission
--FROM country_master as i
FROM CO2country_industry
LEFT JOIN country_master as c ON c.country_code = CO2country_code
LEFT JOIN industry_master as i ON i.industry_code = co2Industry_code
WHERE c.Country IS NOT NULL
AND i.industry IN ('Agriculture, Forestry and Fishing','Construction',
'Electricity, gas, steam and air conditioning supply','Manufacturing','Mining',
'Transportation and Storage','Food products, beverages and tobacco','Air transport','Chemicals and pharmaceutical products',
'Water transport','Rubber and plastics products')
AND unit IN ('Metric Tons of CO2 Emissions per $1million USD of output')
GROUP BY c.Country, i.industry, Year
ORDER BY Emission desc;
""", cn)
cursor.close()
surfacetemp.to_csv("./data/query_results/Country_industry_emission.csv", index= False)
quit
Industry <- read.csv("data/query_results/Country_industry_emission.csv.csv")
library(tidyverse)
library(dplyr)
library(ggplot2)
library(forcats)
library(reticulate)
use_python("C:/Users/stanley varghese/AppData/Local/Programs/Python/Python311/python.exe")
Industry1 <- read.csv("data/query_results/Country_industry_emission.csv.csv")
Industry1 <- read.csv("data/query_results/Country_industry_emission.csv.csv")
Industry1 <- read.csv("./data/query_results/Country_industry_emission.csv.csv")
# region wise gastype -
gas <- read.csv("./data/query_results/emmision_gastype_region.csv")
# Create the ggplot
p2 <- gas %>%
filter(!(country %in% c('G20', 'G7','Advanced Economies'))) %>%
arrange(desc(emission)) %>%
ggplot(aes(x = reorder(country, -emission), y = emission/100, fill = gastype)) +
geom_bar(stat = "identity", size = 2, alpha = 0.9, group = 1) +
#facet_wrap(~gastype, ncol = 2, scales = "free_x") +
scale_y_continuous(
breaks = seq(0, 15000, length.out = 11),
labels = seq(0, 15000, length.out = 11)
) +
theme_minimal() +
labs(
title = "Region Vs Gastype Emission",
x = "Region",
y = "Emission in Metric Ton",
caption = "International Monetary Fund - IMF"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(p2)
Industry1 <- read.csv("./data/query_results/Country_industry_emission.csv.csv")
p3 <- read.csv("./data/query_results/Country_industry_emission.csv.csv")
p3 <- read.csv("./data/query_results/Country_industry_emission.csv")
# Create the ggplot
emi <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 5000, by = 100)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "year",
y = "Emission",
caption = "International Monetary Fund - IMF"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
Industry <- read.csv("./data/query_results/Country_industry_emission.csv")
# Create the ggplot
emi <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(p2, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 5000, by = 100)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "year",
y = "Emission",
caption = "International Monetary Fund - IMF"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
Industry <- read.csv("./data/query_results/Country_industry_emission.csv")
# Create the ggplot
emi <-Industry  %>%
filter(Country %in% c('United States', 'China', 'Japan', 'Germany', 'United Kingdom', 'India', 'France'))
ggplot(emi, aes(x = Year, y = Emission/100, fill = industry)) +
geom_bar(stat = "identity", size = .1, alpha = 0.9) +
facet_wrap(~Country, ncol = 2, scales = "free_x") +
scale_x_continuous(breaks = seq(1995, 2020, by = 2)) +
scale_y_continuous(
breaks = seq(0, 5000, by = 100)
) +
theme_classic() +
labs(
title = "Industry Vs Country",
x = "year",
y = "Emission",
caption = "International Monetary Fund - IMF"
) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
print(emi)
